<dom-module id="music-clef">
  <template>
    <style>
      :host {
        display: block;
      }
      .triangle {
        border: 2px solid white;
        font-size: 10px;
        width: 50px;
        transform-origin: bottom left;
        position: absolute;
        top: 100px;
        left: 100px;
      }
    </style>
    <template is="dom-repeat" items="[[notes]]">
      <div class="triangle" style$="[[_getStyle(item)]]">[[item]]: [[_getNotePositionInWheelOf5ByName(item)]]</div>
    </template>
  </template>
  <script>

    class MusicClef extends Polymer.Element {
      static get is() {
        return "music-clef";
      }

      static get config() {
        return {
          properties: {
            mode: {
              type:String,
              notify: true,
              observer: "setup"
            },
            key: {
              type:String,
              notify: true,
              observer: "setup"
            }
          }
        }
      }

      setup(){
        console.log("key: "+this.key);
        console.log("mode: "+this.mode);
        let scale = this.querySelector("music-scale");
        this.notes = scale.staticNotes;//["C", "G", "D", "A", "E", "B", "F#","C#", "G#", "D#", "A#", "F"];
//        this.notes = scale.getWheelOf5();
        //iterate through the notes and set to visible
//        this.active = scale.getActiveNotes();
//        this.chordTypes = scale.getChordTypes(mode);
      }

      _getNotePositionInWheelOf5ByName(noteName){
        let scale = this.querySelector("music-scale");
        return scale.getNotePositionInWheelOf5ByName(noteName);
      }

      _getStyle(noteName){
        let notePos = this._getNotePositionInWheelOf5ByName(noteName);
        let deg = Math.floor(notePos/12*360);
        return "background-color: hsl("+ deg +", 100%, 50%);"
        + " transform: rotate("+deg+"deg);";
      }

    }
    customElements.define(MusicClef.is, MusicClef);
  </script>
</dom-module>